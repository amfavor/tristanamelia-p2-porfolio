---
title: "R Coding Exercise"
---

#Part 1 - Amelia Tristan
```{r}
#installed and calling dslabs, tidyverse
library(dslabs)
library(tidyverse)
library(ggplot2)

#open help page for gapminder data and explore the data structure, class, and contents
help(gapminder) #help page
str(gapminder) #structure
summary(gapminder) #contents
class(gapminder) #class

gapminder
```

```{r}
#filtering gapminder data to include only Africa
africadata = dplyr::filter(gapminder, continent == "Africa")
str(africadata) #explore structure
summary(africadata) #explore filtered data
```
```{r}
#selection of variables from africadata
ad1 = dplyr::select(africadata, infant_mortality, life_expectancy) #selecting infant_mortality and #life expectancy

ad2 = dplyr::select(africadata, population, life_expectancy) #selecting pop and life expectancy

#exploring structure and data contents for each new data set
str(ad1) #structure for ad1
str(ad2) #structure for ad2
summary(ad1) #content summary for ad1
summary(ad2) #content summary for ad2
```
```{r}
plot(ad1$infant_mortality, ad1$life_expectancy)
#plot(ad2$population, ad2$life_expectancy)

plot2 = ggplot(gapminder, aes(log10(population), life_expectancy)) + geom_point()
plot2
```
As infant mortality rates increase, life expectancy decreases. As population increases, life expectancy increases, but only up to a certain population amount before the population becomes detrimental to life expectancy and "resets."

```{r}
#filter and select null infant mortality years in africa data
adna <- africadata %>% dplyr::filter(is.na(infant_mortality)) %>% dplyr::select(year)
adna$year #print all years with null infant mortality

#filtering to only the year 2000
ad2000 <- africadata %>% dplyr::filter(year == 2000)
summary(ad2000) #summary of contents
str(ad2000) #structure
```
```{r}
#plotting infant mortality by life expectancy for year 2000
plot(ad2000$infant_mortality, ad2000$life_expectancy)
#plotting life population by life expectancy for year 2000 on population axis scaled by log10
plot3 = ggplot(ad2000, aes(log10(population), life_expectancy)) + geom_point()
plot3 #print plot
```
```{r}
#life_expectancy~infant_mortality model fit for year 2000
inf_le_fit = lm(life_expectancy~infant_mortality, data = ad2000)
##life_expectancy~population model fit for year 2000
pop_le_fit = lm(life_expectancy~population, data = ad2000)

summary(inf_le_fit)
summary(pop_le_fit)
```
I created two linear models using lm() function with life expectancy as the dependent variable for both infant mortality and population as the single predictor. 
Based on the fitted models, population is more significant than infant mortality, with a corresponding high r-squared value. The best model would be the population model.

#Part 2 - Amelia Tristan
Moji Popoola attempted to work on this part of the exercise but had issues with github and pull requests. I will be using mice_weights dataset from dslabs package.

```{r}
#open help page for mice_weights data and explore the data structure, class, and contents
help(mice_weights) #help page
str(mice_weights) #structure
summary(mice_weights) #contents
class(mice_weights) #class

mice_weights

#filtering out any null values. data is already mostly clean with just 8 null entries in the entire data set (4 each in two variables)
mw_clean <- mice_weights %>%  dplyr::filter(!(is.na(bone_density)), !(is.na(percent_fat)))


#checking distribution (boxplot) of percent_fat as a predictor of body_weight by sex.
mw_clean %>% ggplot(aes(percent_fat, body_weight)) + geom_boxplot() + facet_wrap(~sex)

#checking distribution of diet as a predictor of body_weight by sex
mw_clean %>% ggplot(aes(diet, body_weight)) + geom_boxplot() + facet_wrap(~sex)

#scatter of percent_fat as a predictor of body_weight by sex.
mw_clean %>% ggplot(aes(percent_fat, body_weight)) + geom_point() + facet_wrap(~sex)

#scatter of bone_density as a predictor of body_weight by sex.
mw_clean %>% ggplot(aes(bone_density, body_weight)) + geom_point() + facet_wrap(~sex)
```
I will be focusing on body weight as the dependent variable. The first boxplot explores the distribution of body weight by percent fat by each sex. Females have more outliers than males and lower average body weight. The second boxplot explores the distribution of body weight by diet dy sex. Again females have more outliers and lower average body weight than males. However, the HF diet produces higher body weights in both sexes than chow diet. The next scatter plot shows a positive relationship between percent fat and body weight. The last plot shows a loosely clustered positive relationship between bone density and body weight.I will continue fitting two models of body weight with percent fat and bone density as the predictor.

```{r}
#fitting two linear models for bodyweight by percent fat and bone density
mw_pf_bw_fit = lm(body_weight~percent_fat, data = mw_clean)
mw_bd_bw_fit = lm(body_weight~bone_density, data = mw_clean)

#summary of each model
summary(mw_pf_bw_fit)
summary(mw_bd_bw_fit)
```
The two models' predictors both have low significance for body weight. However, based on the r-squared values, the model with percent fat is a much better fit (0.43) than the bone density model (0.13).

